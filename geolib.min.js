/**
 * A small library to provide some basic geo functions like distance calculation,
 * conversion of decimal coordinates to sexagesimal and vice versa, etc.
 * 
 * @author Manuel Bieh
 * @url http://www.manuel-bieh.de/
 * @version 1.0.1
 * @license http://www.gnu.org/licenses/lgpl-3.0.txt LGPL
 *
 */
(function(){var a=6378137;var b=/^([0-9]{1,3})°\s*([0-9]{1,3})'\s*(([0-9]{1,3}(\.([0-9]{1,2}))?)"\s*)?([NEOSW]?)$/;var c={decimal:{},sexagesimal:{},distance:0,getDistance:function(){var b=[];var d=[];var e;switch(arguments.length){case 5:e=arguments[4];case 5:case 4:b[0]=arguments[0];b[1]=arguments[1];d[0]=arguments[2];d[1]=arguments[3];break;case 3:e=arguments[2];case 3:case 2:b=arguments[0]instanceof Array?arguments[0]:arguments[0].split(",");d=arguments[1]instanceof Array?arguments[1]:arguments[1].split(",");b[0]=c.useDecimal(b[0]);b[1]=c.useDecimal(b[1]);d[0]=c.useDecimal(d[0]);d[1]=c.useDecimal(d[1]);break}e=e||1;var f=b[0]/180*Math.PI;var g=b[1]/180*Math.PI;var h=d[0]/180*Math.PI;var i=d[1]/180*Math.PI;var j=Math.round(Math.acos(Math.sin(h)*Math.sin(f)+Math.cos(h)*Math.cos(f)*Math.cos(g-i))*a);return c.distance=parseInt(Math.round(j/e)*e)},getCenter:function(a){max=function(a){return Math.max.apply(Math,a)};min=function(a){return Math.min.apply(Math,a)};var b,d,e={lat:[],lng:[]};for(coord in a){var f=a[coord].split(",");e.lat.push(c.useDecimal(parseFloat(f[0])));e.lng.push(c.useDecimal(parseFloat(f[1])))}var g=min(e.lat);var h=min(e.lng);var i=max(e.lat);var j=max(e.lng);b=((g+i)/2).toFixed(6);d=((h+j)/2).toFixed(6);var k=c.convertUnit("km",c.getDistance(g,h,i,j));return{lat:b,lng:d,distance:k}},convertUnit:function(a,b,d){if(b==0||typeof b=="undefined"){if(c.distance==0){return 0}else{b=c.distance}}a=a||"m";d=d||4;switch(a){case"m":return c.round(b,d);break;case"km":return c.round(b/1e3,d);break;case"cm":return c.round(b*100,d);break;case"mm":return c.round(b*1e3,d);break;case"mi":return c.round(b*(1/1609.344),d);break;case"sm":return c.round(b*(1/1852.216),d);break;case"ft":return c.round(b*(100/30.48),d);break;case"in":return c.round(b*100/2.54,d);break;case"yd":return c.round(b*(1/.9144),d);break}return b},useDecimal:function(a){a=a.replace(/\s*/,"");if(!isNaN(parseFloat(a))&&parseFloat(a).toString()==a){return a}else if(c.isSexagesimal(a)==true){return c.sexagesimal2decimal(a)}else{throw"Unknown format."}},decimal2sexagesimal:function(a){tmp=a.toString().split(".");var b=tmp[0];var d=("0."+tmp[1])*60;var e=d.toString().split(".");d=parseInt(d);e=(("0."+e[1])*60).toFixed(2);c.sexagesimal[a]=b+"° "+d+"' "+e+'"';return c.sexagesimal[a]},sexagesimal2decimal:function(a){var d=new RegExp(b);var e=d.exec(a);if(!!e){var f=parseFloat(e[2]/60);var g=parseFloat(e[4]/3600)||0}var h=(parseFloat(e[1])+f+g).toFixed(8);h=e[7]=="S"||e[7]=="W"?h*-1:h;c.decimal[a]=h;return h},isSexagesimal:function(a){return b.test(a)},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}};window.geolib=c})()